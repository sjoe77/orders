<turbo-frame id="<%= table_id %>">
  <div class="table-container">
    <!-- Table Section -->
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <!-- Default Header -->
          <thead class="table-secondary">
            <tr>
              <% if config[:show_delete_checkboxes] %>
                <th class="text-center" style="width: 50px; padding: 8px;">
                  Select
                </th>
              <% end %>

              <% columns.each do |field, column_config| %>
                <th class="<%= column_alignment_class(column_config[:format]) %>">
                  <% if column_config[:sortable] %>
                    <%= table_sort_link(field,
                        I18n.t("attributes.#{config[:entity_name]}.#{field}")) %>
                  <% else %>
                    <%= I18n.t("attributes.#{config[:entity_name]}.#{field}") %>
                  <% end %>
                </th>
              <% end %>

              <% aggregate_columns.each do |field, column_config| %>
                <th class="<%= column_alignment_class(column_config[:format]) %>">
                  <% if column_config[:sortable] %>
                    <%= table_sort_link(field,
                        I18n.t("attributes.#{config[:entity_name]}.#{field}")) %>
                  <% else %>
                    <%= I18n.t("attributes.#{config[:entity_name]}.#{field}") %>
                  <% end %>
                </th>
              <% end %>
            </tr>
          </thead>

        <tbody data-controller="clickable-rows">
          <!-- Default Rows -->
            <% collection.records.each do |record| %>
              <tr data-clickable-rows-target="row"
                  data-record-id="<%= record.id %>"
                  data-action="click->clickable-rows#rowClicked"
                  style="cursor: pointer;">

                <% if config[:show_delete_checkboxes] %>
                  <td class="text-center align-middle"
                      onclick="event.stopPropagation();"
                      style="padding: 12px;">
                    <input type="checkbox"
                           class="form-check-input delete-checkbox"
                           name="<%= config[:delete_checkbox_name] %>"
                           value="<%= record.id %>"
                           data-controller="checkbox-toggle"
                           data-action="change->checkbox-toggle#updateDeleteButton"
                           style="width: 18px; height: 18px; cursor: pointer;">
                  </td>
                <% end %>

                <% columns.each do |field, column_config| %>
                  <td class="<%= column_alignment_class(column_config[:format]) %>">
                    <%= format_table_value(
                        record.public_send(field),
                        column_config[:format],
                        column_config
                    ) %>
                  </td>
                <% end %>

                <% aggregate_columns.each do |field, column_config| %>
                  <td class="<%= column_alignment_class(column_config[:format]) %>">
                    <%= format_table_value(
                        record.respond_to?(field) ? record.public_send(field) : nil,
                        column_config[:format],
                        column_config
                    ) %>
                  </td>
                <% end %>
              </tr>
            <% end %>

          <!-- Empty State -->
          <% if collection.empty? %>
            <tr>
              <td colspan="<%= total_columns %>" class="text-center text-muted py-4">
                <em><%= empty_message %></em>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <!-- Pagination Section -->
    <div class="d-flex justify-content-between align-items-center mt-3">
      <div class="text-muted small">
        <%= pagination_info %>
      </div>
      <nav aria-label="Table pagination">
        <%= pagination_links %>
      </nav>
    </div>
  </div>
</turbo-frame>