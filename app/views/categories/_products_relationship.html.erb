<turbo-frame id="category_products">
  <div class="relationship-section">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h6 class="mb-0">Products (<%= @products.total_count %>)</h6>
      <button type="button"
              class="btn btn-primary btn-sm"
              data-bs-toggle="modal"
              data-bs-target="#productLinkModal_category_<%= @category.id %>"
        <i class="bi bi-link"></i> Manage Products
      </button>
    </div>

    <% if !@products.empty? %>
      <%= render TableComponent.new(
        collection: @products,
        config: Product.table_config.merge(
          entity_name: 'product',
          frame_id: 'category_products',
          show_delete_checkboxes: false,
          disable_row_clicks: true,
          base_url: products_category_path(@category)
        ),
        current_params: params.permit!
      ) %>
    <% else %>
      <div class="text-center py-4 text-muted">
        <i class="bi bi-link-45deg fs-1 mb-2 d-block"></i>
        <p class="mb-0">No products linked yet</p>
        <small>Click "Manage Products" to add relationships</small>
      </div>
    <% end %>
  </div>
</turbo-frame>